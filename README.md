# sammler

[![Codeship Status for stefanwalther/sammler](https://img.shields.io/codeship/3f7e9fc0-8c86-0133-d825-1e10e5e69df6.svg?style=flat-square)](https://codeship.com/projects/3f7e9fc0-8c86-0133-d825-1e10e5e69df6)
[![Coveralls](https://img.shields.io/coveralls/stefanwalther/sammler.svg?style=flat-square)](https://coveralls.io/github/stefanwalther/sammler)

> sammler (German word for gatherer) is a node.js library to fetch content from several GitHub repositories and save them locally.

**Work in progress: Nothing to show, yet**

***

## Table of Contents

<!-- toc -->

* [Install](#install)
* [Usage](#usage)
* [FAQ](#faq)
  - [GitHub limits](#github-limits)
* [Contributing](#contributing)
* [Tests](#tests)
* [Author](#author)
* [License](#license)

_(Table of contents generated by [verb])_

<!-- tocstop -->

***

## Install

Install with [npm](https://www.npmjs.com/)

```sh
$ npm i sammler --save
```

## Usage

Use **_sammler_** to fetch contents from GitHub to store them locally.

### General concepts

A _source definition_ contains the following properties:

* `user` - The user on GitHub (e.g. `stefanwalther`). Mandatory.
* `repo` - Name of the repository (e.g. `sammler-test-repo1`). Mandatory.
* `ref` - The branch, defaults to `master`
* `path` - Path to fetch contents from (e.g. `dir-1` n sammler-test-repo1). Defaults to "".
* `recursive` - Whether to fetch contents recursively or not, defaults to false.

### Methods

#### `getContent( sourceDef )`

Retrieve contents from GitHub, based on a single source definition.

```js
"use strict";
var Sammler = require( "./../../dist/" ).Sammler;

var sammler = new Sammler();

var sourceDef = {
    user: "stefanwalther",
    repo: "sammler-test-repo1",
    path: "dir-1",
    ref: "master",
    recursive: true
};

sammler.getContent( sourceDef )
    .then( function ( data ) {
        data.results.forEach( function ( item ) {
            console.log( "\t" + item.path );
        });
    });

// Results:
//  dir-1/.gitkeep
//  dir-1/a.md
//  dir-1/b.md
//  dir-1/images/a.png
//  dir-1/images/b.png
//  dir-1/images/sub-single/single.md
//  dir-1/images/sub/x.md
//  dir-1/images/sub/y.png
//  dir-1/images/sub/z.png
```

#### saveContents()

```js
"use strict";
var Sammler = require( "./../../dist/" ).Sammler;
var path = require( "path" );
var del = require( "del" );

var sammler = new Sammler();

var sourceDef = {
    user: "stefanwalther",
    repo: "sammler-test-repo1",
    path: "dir-1",
    ref: "master",
    recursive: true
};

var targetDir = path.join( __dirname, "./.content/" );

del( targetDir ).then( function () { // Clean the targetDir ...
    sammler.getContent( sourceDef )
        .then( function ( data ) {
            sammler.saveContents( sourceDef, data, targetDir )
                .then( function ( results ) {
                    console.log("Saved all");
                    results.forEach( function ( item ) {
                        console.log( "Item saved: " + item );
                    } )
                } )
        } );
} );
```

## FAQ

### GitHub limits

To overcome the GitHub Api limits create an environment variable called `NODE_SAMMLER_TOKEN`.

## Contributing

## Tests

Before running tests, install mocha

```sh
npm install mocha -g
```

### Run all tests

```sh
npm run test
```

### Run unit tests

```sh
npm run test:unit
```

### Run e2e tests

```sh
npm run test:e2e
```

## Author

**Stefan Walther**

+ [qliksite.io](http://qliksite.io)
* [twitter/waltherstefan](http://twitter.com/waltherstefan)
* [github.com/stefanwalther](http://github.com/stefanwalther)

## License

Released under the MIT license.

***

_This file was generated by [verb-cli](https://github.com/assemble/verb-cli) on December 24, 2015._