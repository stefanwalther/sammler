# sammler-github

[![Codeship Status for stefanwalther/sammler-github](https://img.shields.io/codeship/3f7e9fc0-8c86-0133-d825-1e10e5e69df6.svg?style=flat-square)](https://codeship.com/projects/123942)

> sammler-github (sammler is the German word for gatherer) is a node.js library to fetch content from several GitHub repositories and save them locally.

## Table of Contents

<!-- toc -->

* [Install](#install)
* [Usage](#usage)
* [FAQ](#faq)
  - [GitHub limits](#github-limits)
* [Contributing](#contributing)
* [Tests](#tests)
* [Author](#author)
* [License](#license)

_(Table of contents generated by [verb])_

<!-- tocstop -->

## Install

Install with [npm](https://www.npmjs.com/)

```sh
$ npm i sammler-github --save
```

## Usage

Use **_sammler_** to fetch contents from GitHub to store them locally.

### General concepts

#### Source Definition

A **source definition** contains the following properties:

* `user` - The user on GitHub (e.g. `stefanwalther`). Mandatory.
* `repo` - Name of the repository (e.g. `sammler-test-repo1`). Mandatory.
* `ref` - The branch, defaults to `master`
* `path` - Path to fetch contents from (e.g. `dir-1` n sammler-test-repo1). Defaults to "".
* `recursive` - Whether to fetch contents recursively or not, defaults to false.

**Example:**

```js
var sourceDef = {
    "user": "stefanwalther",
    "repo": "sammler-test-repo1",
    "ref": "",
    "path": "dir-1",
    "recursive": true
}
```

#### GitHub Content

(TBD)

### Methods

#### `fetchContents( sourceDef, gitHubContents, targetDir )`

> Retrieve gitHub contents based on a source-definition and store the results to the given target directory.
Basically calls .getContent() and then .saveContents()

**Parameters**

* `sourceDef` - see Source Definition
* `gitHubContents` - Retrieved gitHub contents
* `targetDir` - Local target directory.

#### `getContent( sourceDef )`

> Retrieve contents from GitHub, based on a single source definition.

**Parameters**

* {Object} `sourceDef` - Source definition object.

**Example**

```js
"use strict";
var SammlerGitHub = require( "./../../dist/" ).SammlerGitHub;

var sammlerGitHub = new SammlerGitHub();

var sourceDef = {
    user: "stefanwalther",
    repo: "sammler-test-repo1",
    path: "dir-1",
    ref: "master",
    recursive: true
};

sammlerGitHub.getContent( sourceDef )
    .then( function ( data ) {
        data.results.forEach( function ( item ) {
            console.log( "\t" + item.path );
        });
    });

// Results:
//  dir-1/.gitkeep
//  dir-1/a.md
//  dir-1/b.md
//  dir-1/images/a.png
//  dir-1/images/b.png
//  dir-1/images/sub-single/single.md
//  dir-1/images/sub/x.md
//  dir-1/images/sub/y.png
//  dir-1/images/sub/z.png
```

#### saveContents( sourceDef, gitHubContents, targetDir)

```js
"use strict";
var SammlerGitHub = require( "./../../dist/" ).SammlerGitHub;
var path = require( "path" );
var del = require( "del" );

var sammlerGitHub = new SammlerGitHub();

var sourceDef = {
    user: "stefanwalther",
    repo: "sammler-test-repo1",
    path: "dir-1",
    ref: "master",
    recursive: true
};

var targetDir = path.join( __dirname, "./.content/" );

del( targetDir ).then( function () { // Clean the targetDir ...
    sammlerGitHub.getContent( sourceDef )
        .then( function ( data ) {
            sammlerGitHub.saveContents( sourceDef, data, targetDir )
                .then( function ( results ) {
                    console.log("Saved all");
                    results.forEach( function ( item ) {
                        console.log( "Item saved: " + item );
                    } )
                } )
        } );
} );
```

## FAQ

### GitHub limits

To overcome the GitHub Api limits create an environment variable called `NODE_SAMMLER_TOKEN`.

## Contributing

Pull requests and stars are always welcome. For bugs and feature requests, [please create an issue](https://github.com/stefanwalther/sammler-github/issues).
The process for contributing is outlined below:

1. Create a fork of the project
2. Work on whatever bug or feature you wish
3. Create a pull request (PR)

It cannot be guaranteed that all PRs will be merged, but they will be evaluated and commented at least.

## Tests

Before running tests, install mocha

```sh
npm install mocha -g
```

**Run all tests**

```sh
npm run test
```

**Run unit tests**

```sh
npm run test:unit
```

**Run e2e tests**

```sh
npm run test:e2e
```

## Author

**Stefan Walther**

+ [qliksite.io](http://qliksite.io)
* [twitter/waltherstefan](http://twitter.com/waltherstefan)
* [github.com/stefanwalther](http://github.com/stefanwalther)

## License

Released under the MIT license.

***

_This file was generated by [verb-cli](https://github.com/assemble/verb-cli) on January 08, 2016._